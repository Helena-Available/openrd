<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FSHD-openrd - æ™ºèƒ½é—®ç­”</title>
    <script src="https://unpkg.byted-static.com/coze/space_ppt_lib/1.0.3-alpha.12/lib/tailwindcss.js"></script>
    <script src="https://unpkg.byted-static.com/fortawesome/fontawesome-free/6.7.2/js/all.min.js" data-auto-replace-svg="nest"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#969FFF',
                        secondary: '#5147FF', 
                        accent: '#3E3987',
                        dark: '#0F0F23',
                        'dark-card': 'rgba(255, 255, 255, 0.05)',
                        'dark-border': 'rgba(255, 255, 255, 0.1)',
                        'text-primary': '#FFFFFF',
                        'text-secondary': 'rgba(255, 255, 255, 0.7)',
                        'text-muted': 'rgba(255, 255, 255, 0.5)'
                    },
                    backdropBlur: {
                        'xs': '2px',
                    },
                    boxShadow: {
                        'glass': '0 8px 32px 0 rgba(150, 159, 255, 0.1)',
                        'glass-inset': 'inset 0 1px 0 0 rgba(255, 255, 255, 0.05)',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background: linear-gradient(135deg, #0F0F23 0%, #1A1A3A 50%, #0F0F23 100%);
            min-height: 100vh;
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px 0 rgba(150, 159, 255, 0.1);
        }
        
        .glass-nav {
            background: rgba(15, 15, 35, 0.95);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .gradient-text {
            background: linear-gradient(135deg, #969FFF, #5147FF);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #969FFF;
            box-shadow: 0 0 0 2px rgba(150, 159, 255, 0.2);
        }
        
        .knowledge-item:hover {
            background: rgba(150, 159, 255, 0.05);
            transform: translateY(-1px);
            transition: all 0.3s ease;
        }
        
        .resource-card:hover {
            transform: translateY(-2px);
            transition: all 0.3s ease;
        }
        
        .question-item:hover {
            background: rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
        }
        
        .answer-panel {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .answer-panel.expanded {
            max-height: 500px;
        }
    </style>
</head>
<body class="bg-dark text-text-primary overflow-x-hidden">
    <!-- iOSçŠ¶æ€æ  -->
    <div id="status-bar" class="flex justify-between items-center px-6 py-2 text-sm text-text-primary">
        <div class="flex items-center space-x-1">
            <span>9:41</span>
        </div>
        <div class="flex items-center space-x-1">
            <i class="fas fa-signal text-xs"></i>
            <i class="fas fa-wifi text-xs"></i>
            <i class="fas fa-battery-three-quarters text-xs"></i>
        </div>
    </div>

    <!-- ä¸»å®¹å™¨ -->
    <div id="main-container" class="max-w-sm mx-auto bg-transparent min-h-screen pb-20">
        <!-- é¡¶éƒ¨æœç´¢åŒºåŸŸ -->
        <header id="header" class="px-6 py-4">
            <div id="search-container" class="relative">
                <div class="flex space-x-2">
                    <input 
                        type="text" 
                        id="search-input" 
                        placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..." 
                        class="flex-1 px-3 py-2 bg-dark-card border border-dark-border rounded-lg text-text-primary placeholder-text-muted search-input text-sm"
                    >
                    <button id="search-button" class="px-3 py-2 bg-primary rounded-lg text-white font-medium">
                        <i class="fas fa-search text-sm"></i>
                    </button>
                </div>
            </div>
        </header>

        <!-- çƒ­é—¨é—®é¢˜ -->
        <section id="hot-questions" class="mx-6 mb-6">
            <h3 id="hot-questions-title" class="text-sm font-semibold text-text-primary mb-2">çƒ­é—¨é—®é¢˜</h3>
            <div id="hot-questions-list" class="space-y-2">
                <div class="question-item glass-card rounded-lg p-2 cursor-pointer" data-question="FSHDæ‚£è€…å¦‚ä½•è¿›è¡Œå®¶åº­åº·å¤è®­ç»ƒï¼Ÿ">
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-primary">FSHDæ‚£è€…å¦‚ä½•è¿›è¡Œå®¶åº­åº·å¤è®­ç»ƒï¼Ÿ</span>
                        <i class="fas fa-chevron-down text-text-muted text-xs transform transition-transform duration-300"></i>
                    </div>
                    <div class="answer-panel mt-1">
                        <div class="text-xs text-text-secondary leading-relaxed">
                            FSHDæ‚£è€…çš„å®¶åº­åº·å¤è®­ç»ƒåº”éµå¾ªä¸ªä½“åŒ–åŸåˆ™ï¼Œé‡ç‚¹åŒ…æ‹¬ï¼š<br><br>
                            1. è‚ŒåŠ›è®­ç»ƒï¼šä½¿ç”¨å¼¹åŠ›å¸¦è¿›è¡ŒæŠ—é˜»è®­ç»ƒï¼Œé‡ç‚¹è®­ç»ƒè‚©å¸¦è‚Œã€ä¸Šè‡‚è‚Œå’Œä¸‹è‚¢è‚Œç¾¤<br>
                            2. å…³èŠ‚æ´»åŠ¨åº¦è®­ç»ƒï¼šæ¯æ—¥è¿›è¡Œå…³èŠ‚çš„å…¨èŒƒå›´æ´»åŠ¨ï¼Œé¢„é˜²å…³èŠ‚æŒ›ç¼©<br>
                            3. å‘¼å¸è®­ç»ƒï¼šè…¹å¼å‘¼å¸å’Œæ·±å‘¼å¸ç»ƒä¹ ï¼Œæ”¹å–„å‘¼å¸åŠŸèƒ½<br>
                            4. å¹³è¡¡è®­ç»ƒï¼šå•è…¿ç«™ç«‹ã€è¶³è·Ÿèµ°ç­‰ç»ƒä¹ ï¼Œé¢„é˜²è·Œå€’<br><br>
                            å»ºè®®åœ¨ä¸“ä¸šåº·å¤å¸ˆæŒ‡å¯¼ä¸‹åˆ¶å®šè®­ç»ƒè®¡åˆ’ï¼Œé¿å…è¿‡åº¦ç–²åŠ³ã€‚
                        </div>
                    </div>
                </div>
                
                <div class="question-item glass-card rounded-lg p-2 cursor-pointer" data-question="FSHDçš„é—ä¼ æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ">
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-primary">FSHDçš„é—ä¼ æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ</span>
                        <i class="fas fa-chevron-down text-text-muted text-xs transform transition-transform duration-300"></i>
                    </div>
                    <div class="answer-panel mt-1">
                        <div class="text-xs text-text-secondary leading-relaxed">
                            FSHDä¸»è¦æœ‰ä¸¤ç§é—ä¼ æ–¹å¼ï¼š<br><br>
                            1. FSHD1å‹ï¼ˆå 95%ï¼‰ï¼šå¸¸æŸ“è‰²ä½“æ˜¾æ€§é—ä¼ ï¼Œç”±4å·æŸ“è‰²ä½“é•¿è‡‚ï¼ˆ4q35ï¼‰ä¸Šçš„D4Z4é‡å¤åºåˆ—ç¼ºå¤±å¼•èµ·<br>
                            2. FSHD2å‹ï¼ˆå 5%ï¼‰ï¼šå¸¸æŸ“è‰²ä½“æ˜¾æ€§é—ä¼ ï¼Œç”±SMCHD1åŸºå› çªå˜å¼•èµ·<br><br>
                            æ‚£è€…å­å¥³æœ‰50%çš„æ¦‚ç‡é—ä¼ è¯¥ç–¾ç—…ï¼Œä½†ä¸´åºŠè¡¨ç°å¯èƒ½å­˜åœ¨å·®å¼‚ã€‚å»ºè®®è¿›è¡Œé—ä¼ å’¨è¯¢å’ŒåŸºå› æ£€æµ‹ã€‚
                        </div>
                    </div>
                </div>
                
                <div class="question-item glass-card rounded-lg p-2 cursor-pointer" data-question="FSHDæ‚£è€…å¯ä»¥å‚åŠ å“ªäº›è¿åŠ¨ï¼Ÿ">
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-text-primary">FSHDæ‚£è€…å¯ä»¥å‚åŠ å“ªäº›è¿åŠ¨ï¼Ÿ</span>
                        <i class="fas fa-chevron-down text-text-muted text-xs transform transition-transform duration-300"></i>
                    </div>
                    <div class="answer-panel mt-1">
                        <div class="text-xs text-text-secondary leading-relaxed">
                            FSHDæ‚£è€…é€‚åˆçš„è¿åŠ¨åŒ…æ‹¬ï¼š<br><br>
                            âœ… æ¨èï¼šæ¸¸æ³³ã€æ°´ä¸­è¿åŠ¨ã€å¤ªææ‹³ã€ç‘œä¼½ã€æ•£æ­¥<br>
                            âš ï¸ è°¨æ…ï¼šæ…¢è·‘ã€éª‘è‡ªè¡Œè½¦ï¼ˆéœ€æ³¨æ„å®‰å…¨ï¼‰<br>
                            âŒ é¿å…ï¼šé«˜å¼ºåº¦åŠ›é‡è®­ç»ƒã€å‰§çƒˆè¿åŠ¨ã€ä¸¾é‡<br><br>
                            è¿åŠ¨æ—¶åº”æ³¨æ„ï¼š<br>
                            â€¢ é¿å…è¿‡åº¦ç–²åŠ³å’Œè‚Œè‚‰ç–¼ç—›<br>
                            â€¢ è¿åŠ¨å‰åå……åˆ†çƒ­èº«å’Œæ‹‰ä¼¸<br>
                            â€¢ å¦‚æœ‰ä¸é€‚ç«‹å³åœæ­¢<br>
                            â€¢ æœ€å¥½åœ¨ä¸“ä¸šæŒ‡å¯¼ä¸‹è¿›è¡Œ
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- çŸ¥è¯†åˆ†ç±» -->
        <section id="knowledge-categories" class="mx-6 mb-6">
            <h3 id="knowledge-title" class="text-sm font-semibold text-text-primary mb-2">çŸ¥è¯†åˆ†ç±»</h3>
            <div id="knowledge-grid" class="grid grid-cols-2 gap-2">
                <div class="knowledge-item glass-card rounded-lg p-2 cursor-pointer" data-category="åˆ†å‹é‰´åˆ«">
                    <div class="flex items-center space-x-2 mb-1">
                        <div class="w-6 h-6 rounded-full bg-primary bg-opacity-20 flex items-center justify-center">
                            <i class="fas fa-dna text-primary text-xs"></i>
                        </div>
                        <h4 class="font-medium text-text-primary text-xs">åˆ†å‹é‰´åˆ«</h4>
                    </div>
                    <p class="text-xs text-text-muted">FSHD1å‹ä¸2å‹çš„åŒºåˆ«</p>
                </div>
                
                <div class="knowledge-item glass-card rounded-lg p-2 cursor-pointer" data-category="ç—‡çŠ¶ç®¡ç†">
                    <div class="flex items-center space-x-2 mb-1">
                        <div class="w-6 h-6 rounded-full bg-secondary bg-opacity-20 flex items-center justify-center">
                            <i class="fas fa-stethoscope text-secondary text-xs"></i>
                        </div>
                        <h4 class="font-medium text-text-primary text-xs">ç—‡çŠ¶ç®¡ç†</h4>
                    </div>
                    <p class="text-xs text-text-muted">è‚Œè‚‰æ— åŠ›ã€ç–¼ç—›å¤„ç†</p>
                </div>
                
                <div class="knowledge-item glass-card rounded-lg p-2 cursor-pointer" data-category="é—ä¼ å’¨è¯¢">
                    <div class="flex items-center space-x-2 mb-1">
                        <div class="w-6 h-6 rounded-full bg-accent bg-opacity-20 flex items-center justify-center">
                            <i class="fas fa-users text-accent text-xs"></i>
                        </div>
                        <h4 class="font-medium text-text-primary text-xs">é—ä¼ å’¨è¯¢</h4>
                    </div>
                    <p class="text-xs text-text-muted">å®¶æ—é—ä¼ é£é™©è¯„ä¼°</p>
                </div>
                
                <div class="knowledge-item glass-card rounded-lg p-2 cursor-pointer" data-category="ç”¨è¯æŒ‡å¯¼">
                    <div class="flex items-center space-x-2 mb-1">
                        <div class="w-6 h-6 rounded-full bg-green-500 bg-opacity-20 flex items-center justify-center">
                            <i class="fas fa-pills text-green-400 text-xs"></i>
                        </div>
                        <h4 class="font-medium text-text-primary text-xs">ç”¨è¯æŒ‡å¯¼</h4>
                    </div>
                    <p class="text-xs text-text-muted">è¯ç‰©ä½¿ç”¨æ³¨æ„äº‹é¡¹</p>
                </div>
            </div>
        </section>

        <!-- åœ°åŸŸåŒ–èµ„æºæ¨è -->
        <section id="local-resources" class="mx-6 mb-6">
            <div class="flex items-center justify-between mb-2">
                <h3 id="resources-title" class="text-sm font-semibold text-text-primary">é™„è¿‘èµ„æº</h3>
                <button id="view-all-resources" class="text-primary text-xs">æŸ¥çœ‹å…¨éƒ¨</button>
            </div>
            <div id="resources-list" class="space-y-2">
                <div class="resource-card glass-card rounded-lg p-2 cursor-pointer" data-resource="åè¥¿åŒ»é™¢FSHDè¯Šç–—ä¸­å¿ƒ">
                    <div class="flex items-start space-x-2">
                        <div class="w-8 h-8 rounded-full bg-primary bg-opacity-20 flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-hospital text-primary text-xs"></i>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-medium text-text-primary text-xs mb-0.5">åè¥¿åŒ»é™¢FSHDè¯Šç–—ä¸­å¿ƒ</h4>
                            <p class="text-xs text-text-secondary mb-0.5">è·ç¦»æ‚¨ 2.3 å…¬é‡Œ</p>
                            <p class="text-xs text-text-muted">ä¸“ä¸šFSHDè¯Šæ–­ä¸æ²»ç–—</p>
                        </div>
                        <div class="text-right">
                            <div class="text-xs text-green-400 mb-0.5">â­ 4.8</div>
                            <div class="text-xs text-text-muted">ä¸‰ç”²åŒ»é™¢</div>
                        </div>
                    </div>
                </div>
                
                <div class="resource-card glass-card rounded-lg p-2 cursor-pointer" data-resource="åº·å¤ä¹‹å®¶ç†ç–—ä¸­å¿ƒ">
                    <div class="flex items-start space-x-2">
                        <div class="w-8 h-8 rounded-full bg-secondary bg-opacity-20 flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-heartbeat text-secondary text-xs"></i>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-medium text-text-primary text-xs mb-0.5">åº·å¤ä¹‹å®¶ç†ç–—ä¸­å¿ƒ</h4>
                            <p class="text-xs text-text-secondary mb-0.5">è·ç¦»æ‚¨ 1.8 å…¬é‡Œ</p>
                            <p class="text-xs text-text-muted">ä¸“ä¸šåº·å¤è®­ç»ƒæŒ‡å¯¼</p>
                        </div>
                        <div class="text-right">
                            <div class="text-xs text-green-400 mb-0.5">â­ 4.6</div>
                            <div class="text-xs text-text-muted">åŒ»ä¿å®šç‚¹</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ä¸´åºŠè·¯å¾„æŒ‡å¼• -->
        <section id="clinical-pathways" class="mx-6 mb-6">
            <h3 id="pathways-title" class="text-sm font-semibold text-text-primary mb-2">ä¸´åºŠè·¯å¾„</h3>
            <div id="pathways-list" class="space-y-2">
                <div class="glass-card rounded-lg p-2 cursor-pointer" data-pathway="åˆè¯Šæ£€æŸ¥æµç¨‹">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <div class="w-6 h-6 rounded-full bg-blue-500 bg-opacity-20 flex items-center justify-center">
                                <i class="fas fa-clipboard-list text-blue-400 text-xs"></i>
                            </div>
                            <div>
                                <h4 class="font-medium text-text-primary text-xs">åˆè¯Šæ£€æŸ¥æµç¨‹</h4>
                                <p class="text-xs text-text-muted">æ ‡å‡†åŒ–è¯Šæ–­æ£€æŸ¥é¡¹ç›®</p>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-text-muted text-xs"></i>
                    </div>
                </div>
                
                <div class="glass-card rounded-lg p-2 cursor-pointer" data-pathway="éšè®¿ç®¡ç†è®¡åˆ’">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <div class="w-6 h-6 rounded-full bg-purple-500 bg-opacity-20 flex items-center justify-center">
                                <i class="fas fa-calendar-check text-purple-400 text-xs"></i>
                            </div>
                            <div>
                                <h4 class="font-medium text-text-primary text-xs">éšè®¿ç®¡ç†è®¡åˆ’</h4>
                                <p class="text-xs text-text-muted">å®šæœŸå¤æŸ¥ä¸è¯„ä¼°å®‰æ’</p>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-text-muted text-xs"></i>
                    </div>
                </div>
                
                <div class="glass-card rounded-lg p-2 cursor-pointer" data-pathway="åº·å¤æ²»ç–—æŒ‡å—">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-2">
                            <div class="w-6 h-6 rounded-full bg-orange-500 bg-opacity-20 flex items-center justify-center">
                                <i class="fas fa-dumbbell text-orange-400 text-xs"></i>
                            </div>
                            <div>
                                <h4 class="font-medium text-text-primary text-xs">åº·å¤æ²»ç–—æŒ‡å—</h4>
                                <p class="text-xs text-text-muted">ä¸ªæ€§åŒ–åº·å¤è®­ç»ƒæ–¹æ¡ˆ</p>
                            </div>
                        </div>
                        <i class="fas fa-chevron-right text-text-muted text-xs"></i>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- åº•éƒ¨å¯¼èˆªæ  -->
    <nav id="bottom-nav" class="fixed bottom-0 left-0 right-0 glass-nav flex justify-around items-center h-14 px-2 z-40">
        <a id="nav-home" href="#" class="flex flex-col items-center p-1 text-text-muted">
            <i class="fas fa-home text-base"></i>
            <span class="text-xs mt-0.5">é¦–é¡µ</span>
        </a>
        <a id="nav-qna" href="#" class="flex flex-col items-center p-1 text-primary">
            <i class="fas fa-question-circle text-lg"></i>
            <span class="text-xs mt-0.5">é—®ç­”</span>
        </a>
        <a id="nav-archive" href="#" class="flex flex-col items-center p-1 text-text-muted">
            <i class="fas fa-file-medical-alt text-base"></i>
            <span class="text-xs mt-0.5">æ¡£æ¡ˆ</span>
        </a>
        <a id="nav-community" href="#" class="flex flex-col items-center p-1 text-text-muted">
            <i class="fas fa-users text-base"></i>
            <span class="text-xs mt-0.5">ç¤¾åŒº</span>
        </a>
        <a id="nav-profile" href="#" class="flex flex-col items-center p-1 text-text-muted">
            <i class="fas fa-user text-base"></i>
            <span class="text-xs mt-0.5">æˆ‘çš„</span>
        </a>
    </nav>

    <script>
        // æµ‹è¯•JWTä»¤ç‰Œï¼ˆä½¿ç”¨é»˜è®¤JWT_SECRET 'change-me-super-secret'ï¼‰
        // è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ä»¤ç‰Œï¼Œç”¨äºå¼€å‘ç¯å¢ƒ
        const TEST_JWT_TOKEN = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJ0ZXN0LXVzZXItaWQiLCJyb2xlIjoidXNlciIsImlhdCI6MTczNTIxNjAwMCwiZXhwIjoxNzM1ODIwODAwfQ.4vQq3q7JQ8Xq9Q8Xq9Q8Xq9Q8Xq9Q8Xq9Q8Xq9Q8Xq9Q8';
        
        // APIé…ç½®
        const API_CONFIG = {
            baseUrl: 'http://localhost:4000',
            endpoints: {
                ask: '/api/ai/ask'
            },
            headers: {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${TEST_JWT_TOKEN}`
            }
        };
        
        // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
        function showError(message) {
            const errorHtml = `
                <div class="glass-card rounded-lg p-3 mb-3 border-l-4 border-red-500">
                    <div class="flex items-start space-x-2">
                        <div class="w-6 h-6 rounded-full bg-red-500 bg-opacity-20 flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-exclamation-triangle text-red-500 text-xs"></i>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-medium text-text-primary text-xs mb-1">è¯·æ±‚å¤±è´¥</h4>
                            <p class="text-xs text-text-secondary leading-relaxed">${message}</p>
                        </div>
                    </div>
                </div>
            `;
            
            const hotQuestionsSection = document.querySelector('#hot-questions');
            hotQuestionsSection.insertAdjacentHTML('beforebegin', errorHtml);
        }
        
        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoading() {
            const loadingHtml = `
                <div class="glass-card rounded-lg p-3 mb-3">
                    <div class="flex items-start space-x-2">
                        <div class="w-6 h-6 rounded-full bg-primary bg-opacity-20 flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-spinner fa-spin text-primary text-xs"></i>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-medium text-text-primary text-xs mb-1">æ­£åœ¨æ€è€ƒä¸­...</h4>
                            <p class="text-xs text-text-secondary leading-relaxed">æ­£åœ¨åˆ†ææ‚¨çš„é—®é¢˜å¹¶æ£€ç´¢ç›¸å…³çŸ¥è¯†åº“</p>
                        </div>
                    </div>
                </div>
            `;
            
            const hotQuestionsSection = document.querySelector('#hot-questions');
            hotQuestionsSection.insertAdjacentHTML('beforebegin', loadingHtml);
            return document.querySelector('#hot-questions').previousElementSibling;
        }
        
        // ç§»é™¤åŠ è½½çŠ¶æ€
        function removeLoading(loadingElement) {
            if (loadingElement && loadingElement.parentNode) {
                loadingElement.remove();
            }
        }
        
        // å‘é€é—®é¢˜åˆ°AI API
        async function sendQuestionToAI(question) {
            try {
                const response = await fetch(`${API_CONFIG.baseUrl}${API_CONFIG.endpoints.ask}`, {
                    method: 'POST',
                    headers: API_CONFIG.headers,
                    body: JSON.stringify({
                        question: question,
                        userContext: {
                            platform: 'web-ui',
                            timestamp: new Date().toISOString()
                        }
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(errorData.message || `HTTPé”™è¯¯: ${response.status}`);
                }
                
                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.message || 'APIè¿”å›å¤±è´¥');
                }
                
                return data.data;
            } catch (error) {
                console.error('APIè°ƒç”¨å¤±è´¥:', error);
                throw error;
            }
        }
        
        // æ ¼å¼åŒ–å›ç­”
        function formatAnswer(question, answerData) {
            const { answer, knowledgeChunks = [], references = [] } = answerData;
            
            // æ„å»ºå¼•ç”¨ä¿¡æ¯
            let referencesHtml = '';
            if (references.length > 0) {
                referencesHtml = `
                    <div class="mt-3 pt-3 border-t border-dark-border">
                        <h5 class="text-xs font-medium text-text-primary mb-2">ğŸ“š çŸ¥è¯†åº“å¼•ç”¨</h5>
                        <div class="space-y-1">
                            ${references.slice(0, 3).map(ref => `
                                <div class="text-xs text-text-secondary bg-dark-card rounded p-2">
                                    <div class="font-medium">${ref.sourceFile || 'æœªçŸ¥æ–‡æ¡£'}</div>
                                    <div class="text-text-muted mt-0.5">${ref.preview || 'æ— é¢„è§ˆå†…å®¹'}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            // æ„å»ºè®°å¿†å¼•ç”¨ä¿¡æ¯
            let memoryInfo = '';
            if (knowledgeChunks.length > 0) {
                memoryInfo = `
                    <div class="mt-2 text-xs text-text-muted">
                        <i class="fas fa-brain mr-1"></i> æœ¬æ¬¡å›ç­”å‚è€ƒäº† ${knowledgeChunks.length} ä¸ªçŸ¥è¯†ç‰‡æ®µ
                    </div>
                `;
            }
            
            return `
                <div class="glass-card rounded-lg p-3 mb-3">
                    <div class="flex items-start space-x-2">
                        <div class="w-6 h-6 rounded-full bg-primary bg-opacity-20 flex items-center justify-center flex-shrink-0">
                            <i class="fas fa-robot text-primary text-xs"></i>
                        </div>
                        <div class="flex-1">
                            <h4 class="font-medium text-text-primary text-xs mb-1">æ™ºèƒ½å›ç­”</h4>
                            <div class="text-xs text-text-secondary leading-relaxed">
                                ${answer.replace(/\n/g, '<br>')}
                            </div>
                            ${memoryInfo}
                            ${referencesHtml}
                            <div class="mt-3 text-xs text-text-muted flex items-center">
                                <i class="fas fa-clock mr-1"></i> ${new Date().toLocaleTimeString('zh-CN')}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // æœç´¢åŠŸèƒ½
            document.querySelector('#search-button').addEventListener('click', async function() {
                const searchInput = document.querySelector('#search-input');
                const question = searchInput.value.trim();
                
                if (question) {
                    console.log('ç”¨æˆ·æé—®:', question);
                    
                    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                    const originalButtonHtml = this.innerHTML;
                    this.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                    this.disabled = true;
                    
                    // æ˜¾ç¤ºåŠ è½½UI
                    const loadingElement = showLoading();
                    
                    try {
                        // å‘é€APIè¯·æ±‚
                        const answerData = await sendQuestionToAI(question);
                        
                        // ç§»é™¤åŠ è½½çŠ¶æ€
                        removeLoading(loadingElement);
                        
                        // æ ¼å¼åŒ–å¹¶æ˜¾ç¤ºå›ç­”
                        const answerHtml = formatAnswer(question, answerData);
                        
                        // åœ¨çƒ­é—¨é—®é¢˜å‰æ’å…¥å›ç­”
                        const hotQuestionsSection = document.querySelector('#hot-questions');
                        hotQuestionsSection.insertAdjacentHTML('beforebegin', answerHtml);
                        
                        // æ¸…ç©ºæœç´¢æ¡†
                        searchInput.value = '';
                        
                    } catch (error) {
                        // ç§»é™¤åŠ è½½çŠ¶æ€
                        removeLoading(loadingElement);
                        
                        // æ˜¾ç¤ºé”™è¯¯
                        showError(`æ— æ³•è·å–å›ç­”: ${error.message}`);
                        console.error('é—®ç­”å¤±è´¥:', error);
                    } finally {
                        // æ¢å¤æŒ‰é’®çŠ¶æ€
                        this.innerHTML = originalButtonHtml;
                        this.disabled = false;
                    }
                }
            });

            // æœç´¢æ¡†å›è½¦äº‹ä»¶
            document.querySelector('#search-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.querySelector('#search-button').click();
                }
            });

            // çƒ­é—¨é—®é¢˜å±•å¼€/æ”¶èµ·
            document.querySelectorAll('.question-item').forEach(item => {
                item.addEventListener('click', function() {
                    const answerPanel = this.querySelector('.answer-panel');
                    const chevron = this.querySelector('.fa-chevron-down');
                    
                    if (answerPanel.classList.contains('expanded')) {
                        answerPanel.classList.remove('expanded');
                        chevron.style.transform = 'rotate(0deg)';
                    } else {
                        // å…ˆæ”¶èµ·æ‰€æœ‰å…¶ä»–é—®é¢˜
                        document.querySelectorAll('.answer-panel').forEach(panel => {
                            panel.classList.remove('expanded');
                        });
                        document.querySelectorAll('.fa-chevron-down').forEach(c => {
                            c.style.transform = 'rotate(0deg)';
                        });
                        
                        // å±•å¼€å½“å‰é—®é¢˜
                        answerPanel.classList.add('expanded');
                        chevron.style.transform = 'rotate(180deg)';
                    }
                });
            });

            // çŸ¥è¯†åˆ†ç±»ç‚¹å‡»
            document.querySelectorAll('.knowledge-item').forEach(item => {
                item.addEventListener('click', function() {
                    const category = this.dataset.category;
                    console.log('ç‚¹å‡»çŸ¥è¯†åˆ†ç±»:', category);
                    
                    // æ¨¡æ‹Ÿè·³è½¬åˆ°çŸ¥è¯†åº“è¯¦æƒ…ï¼ˆå½“å‰é¡µå†…å±•å¼€ï¼‰
                    alert(`æ­£åœ¨åŠ è½½"${category}"ç›¸å…³çŸ¥è¯†...`);
                });
            });

            // åœ°åŸŸåŒ–èµ„æºç‚¹å‡»
            document.querySelectorAll('.resource-card').forEach(card => {
                card.addEventListener('click', function() {
                    const resource = this.dataset.resource;
                    console.log('ç‚¹å‡»èµ„æº:', resource);
                    
                    // è·³è½¬åˆ°åŒ»ç–—èµ„æºåœ°å›¾é¡µ
                    window.location.href = 'P-RESOURCE_MAP.html';
                });
            });

            // æŸ¥çœ‹å…¨éƒ¨èµ„æº
            document.querySelector('#view-all-resources').addEventListener('click', function() {
                window.location.href = 'P-RESOURCE_MAP.html';
            });

            // ä¸´åºŠè·¯å¾„ç‚¹å‡»
            document.querySelectorAll('#pathways-list .glass-card').forEach(card => {
                card.addEventListener('click', function() {
                    const pathway = this.dataset.pathway;
                    console.log('ç‚¹å‡»ä¸´åºŠè·¯å¾„:', pathway);
                    
                    // æ¨¡æ‹Ÿå±•å¼€è¯¦æƒ…ï¼ˆå½“å‰é¡µå†…å±•å¼€ï¼‰
                    alert(`æ­£åœ¨åŠ è½½"${pathway}"è¯¦ç»†å†…å®¹...`);
                });
            });

            // åº•éƒ¨å¯¼èˆªæ 
            document.querySelector('#nav-home').addEventListener('click', function(e) {
                e.preventDefault();
                window.location.href = 'P-HOME.html';
            });

            document.querySelector('#nav-qna').addEventListener('click', function(e) {
                e.preventDefault();
                // å·²åœ¨é—®ç­”é¡µé¢ï¼Œæ— éœ€æ“ä½œ
            });

            document.querySelector('#nav-archive').addEventListener('click', function(e) {
                e.preventDefault();
                window.location.href = 'P-ARCHIVE.html';
            });

            document.querySelector('#nav-community').addEventListener('click', function(e) {
                e.preventDefault();
                window.location.href = 'P-COMMUNITY.html';
            });

            document.querySelector('#nav-profile').addEventListener('click', function(e) {
                e.preventDefault();
                window.location.href = 'P-SETTINGS.html';
            });
        });
    </script>
</body>
</html>